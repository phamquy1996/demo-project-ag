<!DOCTYPE html>
<html>
<head>
  <title>FCM Simple Test</title>
  <script src="https://www.gstatic.com/firebasejs/12.2.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.2.1/firebase-messaging-compat.js"></script>
</head>
<body>
  <button onclick="simpleTest()">Simple Test</button>
  <div id="result"></div>

  <script>
    firebase.initializeApp({
      apiKey: "AIzaSyDHgZwBkp2syivHbLWM6Tgu3UoDBAQB8r0",
      projectId: "smartonetestnoti",
      messagingSenderId: "419243653443",
      appId: "1:419243653443:web:26348d8c428f2688c8d7f6"
    });

    async function simpleTest() {
      try {
        const permission = await Notification.requestPermission();
        if (permission !== 'granted') {
          throw new Error('Permission denied');
        }

        const messaging = firebase.messaging();
        
        // Thử KHÔNG dùng VAPID key trước
        console.log('Getting token WITHOUT VAPID...');
        const token = await messaging.getToken();
        
        document.getElementById('result').innerHTML = `
          <strong>SUCCESS!</strong><br>
          Token: ${token}
        `;
        console.log('Token:', token);
        
      } catch (err) {
        document.getElementById('result').innerHTML = `
          <strong>ERROR:</strong> ${err.message}
        `;
        console.error('Error:', err);
      }
    }
  </script>
</body>
</html>
